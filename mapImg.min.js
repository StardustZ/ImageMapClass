var mapObj,pointObj;var bIsMove=false;var oldpos=curpos=pos={"x":0,"y":0};var scaleValue=1;var bIsExist=false;var brLength=0;function mapImg(b,a,c){bIsExist=true;mapObj=document.getElementById(b);pointObj=document.getElementById(a);this.borderLength=c?c:"512px";mapObj.parentNode.style.width=this.borderLength;mapObj.parentNode.style.height=this.borderLength;mapObj.parentNode.style.border="2px solid white";mapObj.parentNode.style.overflow="hidden";mapObj.parentNode.style.position="relative";mapObj.parentNode.style.marginTop="5px";brLength=transPosition(this.borderLength);document.onmousedown=mouseMoveStart;document.onmouseup=mouseMoveEnd;document.onmousemove=mouseMove;this.currentPos={"x":0,"y":0};this.drawPoint=false;this.setImg=function(d){mapObj.style.background="url("+d+")";mapObj.style.backgroundRepeat="no-repeat";mapObj.style.backgroundSize=this.borderLength+" "+this.borderLength;mapObj.style.width=this.borderLength;mapObj.style.height=this.borderLength;mapObj.style.cursor="move";mapObj.style.position="absolute"};this.drawPos=function(){this.drawPoint=true;pointObj.style.overflow="visible";pointObj.style.position="absolute";pointObj.style.cursor="pointer";pointObj.style.left=transPosition(this.borderLength)/2+"px";pointObj.style.top=transPosition(this.borderLength)/2+"px";pointObj.style.width="8px";pointObj.style.height="8px";pointObj.style.borderRadius="50%";pointObj.style.background="#056FC4";if(!pointObj.firstChild){var d=document.createElement("span");d.style.position="absolute";d.style.borderRadius="50%";d.style.background="#056FC4";d.style.opacity="0.3";d.style.width="16px";d.style.height="16px";d.style.left="-4.5px";d.style.top="-4.5px";pointObj.append(d)}};this.setPos=function(d){if(this.drawPoint){this.currentPos=d;pointObj.style.left=d.x*scaleValue-transPosition(pointObj.style.width)/2+"px";pointObj.style.top=d.y*scaleValue-transPosition(pointObj.style.width)/2+"px"}};this.scaleAdd=function(){if(scaleValue>1.99){return false}var e=bksize(mapObj.style.backgroundSize);var d={"x":parseFloat(e.x)+brLength*0.25,"y":parseFloat(e.y)+brLength*0.25};mapObj.style.backgroundSize=d.x+"px "+d.y+"px";mapObj.style.width=d.x+"px";mapObj.style.height=d.y+"px";e=bksize(mapObj.style.backgroundSize);scaleValue=parseFloat(e.x)/brLength;this.setPos(this.currentPos);return true};this.scaleMinus=function(){if(scaleValue<1.01){return false}var e=bksize(mapObj.style.backgroundSize);var d={"x":parseFloat(e.x)-brLength*0.25,"y":parseFloat(e.y)-brLength*0.25};mapObj.style.backgroundSize=d.x+"px "+d.y+"px";mapObj.style.width=d.x+"px";mapObj.style.height=d.y+"px";e=bksize(mapObj.style.backgroundSize);scaleValue=parseFloat(e.x)/brLength;this.setPos(this.currentPos);return true};this.scaleReset=function(){mapObj.style.backgroundSize=this.borderLength+" "+this.borderLength;mapObj.style.width=this.borderLength;mapObj.style.height=this.borderLength;scaleValue=1;this.setPos(this.currentPos)}}function mousePosition(a){if(a.pageX||a.pageY){return{x:a.pageX,y:a.pageY}}return{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}}function mouseMoveStart(a){a=a||window.event;curpos=mousePosition(a);if(a.target.id==mapObj.id){bIsMove=true}}function mouseMoveEnd(a){a=a||window.event;curpos=mousePosition(a);bIsMove=false}function mouseMove(a){if(!bIsMove){return}a=a||window.event;oldpos=curpos;curpos=mousePosition(a);var d=bksize(mapObj.style.backgroundSize);var c={"x":curpos.x-oldpos.x,"y":curpos.y-oldpos.y};pos.x=pos.x+c.x;pos.y=pos.y+c.y;if(pos.x>0){pos.x=0}else{if(pos.x<-(d.x-brLength)){pos.x=-(d.x-brLength)}}if(pos.y>0){pos.y=0}else{if(pos.y<-(d.y-brLength)){pos.y=-(d.y-brLength)}}var b=pos.x+"px "+pos.y+"px";mapObj.style.left=pos.x+"px";mapObj.style.top=pos.y+"px"}function bksize(c){var a={"x":0,"y":0};c=c.replace("px","");c=c.replace("px","");var b=c.split(" ");a.x=b[0];a.y=b[1];return a}function transPosition(a){var b=0;a=a.replace("px","");b=parseFloat(a);return b};